(this.webpackJsonppasino=this.webpackJsonppasino||[]).push([[25],{144:function(t,e,a){"use strict";a.d(e,"e",(function(){return et})),a.d(e,"g",(function(){return L})),a.d(e,"f",(function(){return U})),a.d(e,"b",(function(){return j})),a.d(e,"a",(function(){return I})),a.d(e,"c",(function(){return M})),a.d(e,"h",(function(){return at})),a.d(e,"i",(function(){return ct})),a.d(e,"d",(function(){return rt}));var n=a(12),i=a(16),s=a(40),o=a(38),u=a(39),r=a(193),c=a(146),l=a(1),d=a(119),b="crash_betAmount",m="crash_payout",h=a(3),f=a.n(h),S=a(10),A=a(169),p=function(){var t=function(){var t=Object(S.a)(f.a.mark((function t(){var e,a,n,i,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e="GEM";try{(a=localStorage.getItem("selectedCoin"))&&(n=JSON.parse(a)).coin&&(e=n.coin)}catch(o){null===(i=Object(l.track)())||void 0===i||i.errors(o),console.error("error when trying to get selected coin"),e=""}return t.next=4,fetch("https://api.pasino.com/account/get-socket-token",{body:JSON.stringify({token:localStorage.getItem("token")}),method:"POST"}).then((function(t){return t.json()})).then((function(t){return t})).catch((function(t){var e;return console.error("Crash get-socket-token error: ",t),null===(e=Object(l.track)())||void 0===e||e.errors(t),null}));case 4:s=t.sent,[{type:"initialization",socket_token:(null===s||void 0===s?void 0:s.socket_token)||""},{type:"get_current_bets"},{type:"get_previous_rounds"},{type:"get_coin_parameters",coin:e}].forEach((function(t){l.crashSocket.send(t)}));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();l.crashSocket.open(t),l.crashSocket.listener(),l.crashSocket.dispatch(A.a),this.socketListener()},_=function(){l.crashSocket.close("Went to another page",!0),Object(A.c)(null)},v=function(t,e){this.updateBalance(t),this.fields.general.playableStatus="play",e?this.error(e):c.b.success({message:"Bet successfully placed!"})},N=a(116),T=function(){var t=this;if(localStorage.getItem("token")){var e=this.fields,a=e.general,n=e.manual,i=e.auto,s=n.betAmount,o=n.payout,u=n.profit,r=a.coinSelected.name,c=i.data;if(c.isOpen){var l=function(){c.winStatus="noPlay",t.setAutoStarted(!c.isStarted),"play"!==a.playableStatus&&(a.playableStatus=c.isStarted?"wait":"watch"),c.isStarted?c.baseBet=n.betAmount:t.stopAutoMode()};switch(a.gameMode){case"new_round":l(),c.isStarted&&this.makeRequest(s,r,o,u);break;case"update_value":"play"===a.playableStatus&&this.exitTheBet(!0);case"crashed":l();break;case"loading":default:a.playableStatus="watch",this.setAutoStarted(!1)}}else switch(a.gameMode){case"update_value":case"crashed":switch(a.playableStatus){case"watch":a.playableStatus="wait";break;case"play":this.exitTheBet(!0);case"wait":default:a.playableStatus="watch"}break;case"loading":a.playableStatus="watch";break;case"new_round":a.playableStatus="wait",this.makeRequest(s,r,o,u,!0)}this.setButtonStatus()}else{var d=this.intl.formatMessage({id:"plinko.bet.notLoggedIn"});N.notifyBarManager.error({message:d})}},E=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.fields,a=e.auto.data;a.isStarted&&(a.winStatus="win"),t?(this.fields.general.isWaitServerAnswer=!0,l.crashSocket.send({type:"cashout_bet"})):(e.general.playableStatus="watch",this.setButtonStatus()),localStorage.removeItem("crashBet")},O=a(126),y=function(t){var e=this,a=this.fields,n=a.general,i=a.manual,s=a.auto,o=i.betAmount,u=i.payout,r=i.profit,c=n.coinSelected.name,l=s.data;n.gameMode=t;var d=document.getElementById("crash-payout-text"),b=null===d||void 0===d?void 0:d.classList;switch(t){case"crashed":if("play"===n.playableStatus||this.fields.general.isWaitServerAnswer){l.winStatus="loss";var m=this.liveValues;O.a.addBet({amount:Number(m.amount),profit:Number(-m.amount),coin:c}),null===b||void 0===b||b.add("canvasVarelaError")}if(l.isStarted)n.playableStatus="wait",this.reactToAutoLimits(),this.reactToAutoParams();else switch(localStorage.removeItem("crashBet"),n.playableStatus){case"wait":n.playableStatus="wait";break;case"play":case"watch":default:n.playableStatus="watch"}this.fields.general.isWaitServerAnswer=!1;break;case"new_round":switch(null===b||void 0===b||b.remove("canvasVarelaError"),n.playableStatus){case"wait":this.makeRequest(o,c,u,r,!l.isStarted)}break;case"update_value":l.isStarted&&"play"!==n.playableStatus?n.playableStatus="wait":l.isOpen&&!l.isStarted&&"play"===n.playableStatus&&setTimeout((function(){e.exitTheBet(!0)}),111)}this.setButtonStatus()},g=function(){this.setAutoStarted(!1);var t=this.fields.general;"play"!==t.playableStatus&&(t.playableStatus="watch");var e=this.fields.auto.data.limitsActualValues;e.profit=0,e.numberOfBets=0,e.betAmount=0,this.updateAutoLimitsField(),this.updateManualFields()},k=function(t){this.fields.auto.values.params=t,this.updateAutoParamsField()},w=function(t){this.fields.auto.values.limits=t,this.updateAutoLimitsField()},C=function(t,e){(Number(e)||0===Number(e))&&(this.fields.manual[t]=e,this.updateDependentManualFields(t),this.updateManualFields())};function B(){var t=this,e=this.fields,a=e.general,n=e.manual;A.b.managerListener=function(e){var i;switch(e.method){case"update_coin_parameters":var s=Number(e.coinPrice.minimum_bet),o=Number(e.coinPrice.maximum_bet);a.coinData={maximum_bet:o,minimum_bet:s,maximum_profit:Number(e.coinPrice.maximum_profit),price:Number(null===(i=e.coinPrice)||void 0===i?void 0:i.price)},n.betAmount=Object(l.toFixed)(Object(l.rangeBetween)(Number(n.betAmount),s,o)),t.updateDependentManualFields(),t.updateManualFields();break;case"crashed":case"new_round":case"update_value":t.setGameMode(e.method);break;case"bet_played":t.acceptBet(e.balance,e.error);break;case"bet_cashedout":t.cashedout(e.balance,e.error);break;case"bet_cashedout_update":e.user_id===a.userId&&t.exitTheBet();break;case"new_bet_finalized":t.finalized(e.coin,e.profit),t.fields.general.isWaitServerAnswer=!1,O.a.addBet({amount:Number(e.amount),profit:Number(e.profit),coin:e.coin});break;case"offline":t.stopAutoMode(),t.fields.general.playableStatus="watch",t.setButtonStatus();var u=document.getElementById("crash-payout-text");u&&(u.innerText="..."),t.setConnection(!1);break;case"online":"offline"===t.connection&&l.crashSocket.send({type:"get_current_bets"}),t.setConnection(!0);break;case"current_bets":var r=t.fields.general,c=r.userId,d=r.playableStatus;(null===e||void 0===e?void 0:e.bets[c])&&!e.bets[c].profit&&"play"!==d&&(t.fields.general.playableStatus="play",t.setButtonStatus())}}}var L,U,j,I,M,G=function(t){this.fields.general.userId=t},V=function(t){var e=this.fields.manual,a=function(){e.profit=Y(e.betAmount,e.payout)},n=function(){e.chance=Z(e.payout)};if(t)switch(t){case"betAmount":a(),localStorage.setItem(b,"".concat(e.betAmount));break;case"payout":a(),n(),localStorage.setItem(m,"".concat(e.payout))}else a(),n()},H=function(t){var e=this;return this.addListener(j.CHANGE_AUTO_OPEN_STATUS,t),function(){e.removeListener(j.CHANGE_AUTO_OPEN_STATUS,t)}},x=function(){var t=this.fields,e=t.auto,a=t.manual,n=t.general,i=e.data,s=e.values,o=n.coinData,u="loss"===i.winStatus?"onLoss":"win"===i.winStatus?"onWin":null;if(u){var r=s.params[u],c=r.value,d=r.isChangePayout,b=r.payoutValue,m=r.betPercentValue;switch(c){case 0:var h=Number(a.betAmount)+Number(a.betAmount)*(Number(m)/100);o&&(h=Object(l.rangeBetween)(h,o.minimum_bet,o.maximum_bet)),a.betAmount=h.toFixed(8);break;case 1:a.betAmount=i.baseBet;break;case 2:this.stopAutoMode()}d&&(a.payout=Number(b))}this.updateManualFields()},P=function(){var t=this.fields,e=t.auto,a=t.manual,n=e.data,i=e.values,s=n.limitsActualValues;switch(s.numberOfBets+=1,s.betAmount+=Number(a.betAmount),n.winStatus){case"loss":s.profit-=Number(a.betAmount);break;case"win":s.profit+=Number(a.betAmount)*Number(a.payout)-Number(a.betAmount)}var o=s.profit,u=s.numberOfBets,r=s.betAmount,c=i.limits,l=c.stopOnLoss,d=c.stopOnProfit,b=c.numberOfBets,m=c.maxBetAmount;Number(l)&&-1*Number(l)-o>=0&&this.stopAutoMode(),Number(d)&&Number(d)-o<=0&&this.stopAutoMode(),Number(b)&&Number(b)-u<=0&&this.stopAutoMode(),Number(m)&&Number(m)-r<=0&&this.stopAutoMode(),this.updateAutoLimitsField()},D=function(){this.emit(L.CHANGE_MANUAL_VALUES_EVENT,this.fields.manual)},F=function(t){var e=this;return this.addListener(j.CHANGE_AUTO_LIMITS_EVENT,t),function(){e.removeListener(j.CHANGE_AUTO_LIMITS_EVENT,t)}},R=function(t){var e=this;return this.addListener(j.CHANGE_AUTO_PARAMS_EVENT,t),function(){e.removeListener(j.CHANGE_AUTO_PARAMS_EVENT,t)}},W=function(t,e){this.fields.general.coinSelected={balance:t,name:e}},q=function(t){var e=this;return this.addListener(L.CHANGE_MANUAL_VALUES_EVENT,t),function(){e.removeListener(L.CHANGE_MANUAL_VALUES_EVENT,t)}},z=function(t){var e=this.fields,a=e.auto,n=e.general,i=a.data;i.isOpen=t,this.setAutoStarted(!1),"play"!==n.playableStatus&&(n.playableStatus="watch"),this.setButtonStatus(),this.emit(j.CHANGE_AUTO_OPEN_STATUS,i.isOpen)},J=function(){this.emit(j.CHANGE_AUTO_PARAMS_EVENT,this.fields.auto.values.params)},K=function(){var t=this.fields.auto,e=t.values,a=(t.data,e.limits);this.emit(j.CHANGE_AUTO_LIMITS_EVENT,a)},Q=function(t){var e=this;return this.addListener(U.CHANGE_BUTTON_STATUS_EVENT,t),function(){e.removeListener(U.CHANGE_BUTTON_STATUS_EVENT,t)}},X=function(t){return(!t||t<0||t===1/0)&&(t=0),t},Y=function(t,e){var a=Number(Object(l.toFixed)(Number(t)*Number(e)-Number(t)));return a=X(a)},Z=function(t){var e=97/Number(t);return e=X(e),Object(l.toFixed)(e,2)},$=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Number(t).toFixed(8);if(l.crashSocket.send({type:"place_bet",bet_amt:i,coin:e,auto_cashout:a}),n)try{localStorage.setItem("crashBet",'{"amt":"'.concat(i,'","coin":"').concat(e,'"}'))}catch(o){var s;null===(s=Object(l.track)())||void 0===s||s.errors(o)}};!function(t){t.CHANGE_MANUAL_VALUES_EVENT="CHANGE_MANUAL_VALUES_EVENT"}(L||(L={})),function(t){t.CHANGE_BUTTON_STATUS_EVENT="CHANGE_BUTTON_STATUS_EVENT",t.CHANGE_IS_DISABLED_STATUS="CHANGE_IS_DISABLED_STATUS"}(U||(U={})),function(t){t.CHANGE_AUTO_OPEN_STATUS="CHANGE_AUTO_OPEN_STATUS",t.CHANGE_AUTO_STARTED_STATUS="CHANGE_AUTO_STARTED_STATUS",t.CHANGE_AUTO_PARAMS_EVENT="CHANGE_AUTO_PARAMS_EVENT",t.CHANGE_AUTO_LIMITS_EVENT="CHANGE_AUTO_LIMITS_EVENT"}(j||(j={})),function(t){t[t.Bet=0]="Bet",t[t.Bet_nextRound=1]="Bet_nextRound",t[t.Wait_cancelBet=2]="Wait_cancelBet",t[t.Wait_loading=3]="Wait_loading",t[t.Cashout=4]="Cashout",t[t.Auto_setStarted=5]="Auto_setStarted",t[t.Auto_setNoStarted=6]="Auto_setNoStarted"}(I||(I={})),function(t){t.CHANGE_CONNECTION="CHANGE_CONNECTION"}(M||(M={}));var tt=function(){var t=this.fields,e=t.general,a=t.auto,n=function(t){e.buttonStatus=t};if(a.data.isOpen)a.data.isStarted?n(I.Auto_setNoStarted):n(I.Auto_setStarted);else switch(e.gameMode){case"loading":n(I.Bet_nextRound);break;case"new_round":switch(e.playableStatus){case"watch":n(I.Bet);break;case"play":default:n(I.Wait_loading)}break;case"update_value":switch(e.playableStatus){case"play":n(I.Cashout);break;case"watch":n(I.Bet_nextRound);break;case"wait":default:n(I.Wait_cancelBet)}break;case"crashed":switch(e.playableStatus){case"wait":n(I.Wait_cancelBet);break;case"watch":default:n(I.Bet_nextRound)}}this.emit(U.CHANGE_BUTTON_STATUS_EVENT,this.fields.general.buttonStatus),this.setDisabled()},et=function(t){Object(o.a)(a,t);var e=Object(u.a)(a);function a(t,i){var o,u;Object(n.a)(this,a),(u=e.call(this)).fields=void 0,u.intl=void 0,u.liveValues={profit:0,amount:0,coin:(null===(o=d.b.selectedCoin)||void 0===o?void 0:o.coin)||""},u.connection="online",u.initCrashSocket=p.bind(Object(s.a)(u)),u.closeCrashSocket=_,u.setGameMode=y.bind(Object(s.a)(u)),u.setAutoLimits=w.bind(Object(s.a)(u)),u.setAutoParams=k.bind(Object(s.a)(u)),u.setManualField=C.bind(Object(s.a)(u)),u.setSelectedCoin=W.bind(Object(s.a)(u)),u.setActiveUserId=G.bind(Object(s.a)(u)),u.setButtonStatus=tt.bind(Object(s.a)(u)),u.setIsAutoModeOpen=z.bind(Object(s.a)(u)),u.updateManualFields=D.bind(Object(s.a)(u)),u.updateAutoParamsField=J.bind(Object(s.a)(u)),u.updateAutoLimitsField=K.bind(Object(s.a)(u)),u.updateDependentManualFields=V.bind(Object(s.a)(u)),u.reactToAutoParams=x.bind(Object(s.a)(u)),u.reactToAutoLimits=P.bind(Object(s.a)(u)),u.betButtonStatusListener=Q.bind(Object(s.a)(u)),u.manualValuesListener=q.bind(Object(s.a)(u)),u.autoIsOpenListener=H.bind(Object(s.a)(u)),u.autoParamsListener=R.bind(Object(s.a)(u)),u.autoLimitListener=F.bind(Object(s.a)(u)),u.acceptBet=v.bind(Object(s.a)(u)),u.exitTheBet=E.bind(Object(s.a)(u)),u.stopAutoMode=g.bind(Object(s.a)(u)),u.buttonOnClick=T.bind(Object(s.a)(u)),u.socketListener=B.bind(Object(s.a)(u)),u.fields=t,u.intl=i;var r=u.fields.manual;return r.betAmount=Object(l.toFixed)(localStorage.getItem(b)||0),r.payout=localStorage.getItem(m)||2,r.chance=Z(r.payout),u}return Object(i.a)(a,[{key:"setConnection",value:function(t){this.connection=t?"online":"offline",this.emit(M.CHANGE_CONNECTION,t)}},{key:"setAutoStarted",value:function(t){this.fields.auto.data.isStarted=t,this.emit(j.CHANGE_AUTO_STARTED_STATUS,this.fields.auto.data.isStarted)}},{key:"setDisabled",value:function(){var t=this.fields.general.buttonStatus===I.Wait_loading||this.fields.general.buttonStatus===I.Auto_setStarted&&"play"===this.fields.general.playableStatus;this.emit(U.CHANGE_IS_DISABLED_STATUS,t)}},{key:"connectionListener",value:function(t){var e=this;return this.addListener(M.CHANGE_CONNECTION,t),function(){e.removeListener(M.CHANGE_CONNECTION,t)}}},{key:"autoStartedListener",value:function(t){var e=this;return this.addListener(j.CHANGE_AUTO_STARTED_STATUS,t),function(){e.removeListener(j.CHANGE_AUTO_STARTED_STATUS,t)}}},{key:"disableListener",value:function(t){var e=this;return this.addListener(U.CHANGE_IS_DISABLED_STATUS,t),function(){e.removeListener(U.CHANGE_IS_DISABLED_STATUS,t)}}},{key:"makeRequest",value:function(t,e,a,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.liveValues.amount=t,this.liveValues.profit=n,this.liveValues.coin=e,$(t,e,a,i)}},{key:"updateBalance",value:function(t){var e,a=this.fields.general;d.b.coinValueUpdate("".concat(t),this.liveValues.coin),a.coinSelected.balance=Number(null===(e=d.b.selectedCoin)||void 0===e?void 0:e.balance)}},{key:"cashedout",value:function(t,e){this.updateBalance(t),e&&this.error(e)}},{key:"finalized",value:function(t,e){var a=this.intl.formatMessage({id:"crashInterface.messages.win"});c.b.success({message:"".concat(a," ").concat(e,"\u202f").concat(t)}),this.fields.general.playableStatus="watch"}},{key:"error",value:function(t){var e=t||"unknown error";c.b.error({message:e,timeOut:4e3}),console.log("crash auto stop error: ",e),this.stopAutoMode(),this.fields.general.playableStatus="watch",this.setButtonStatus()}}]),a}(r.EventEmitter),at={manual:{betAmount:0,payout:0,chance:0,profit:0},general:{gameMode:"loading",buttonStatus:I.Bet_nextRound,playableStatus:"watch",userId:-1,coinSelected:{balance:0,name:"gem"},isWaitServerAnswer:!1},auto:{data:{isOpen:!1,isStarted:!1,winStatus:"noPlay",baseBet:0,limitsActualValues:{numberOfBets:0,profit:0,betAmount:0}},values:{limits:{numberOfBets:5e3,maxBetAmount:0,stopOnLoss:0,stopOnProfit:0},params:{onLoss:{value:1,betPercentValue:"100",isChangePayout:!1,payoutValue:"2"},onWin:{value:1,betPercentValue:"0",isChangePayout:!1,payoutValue:"2"}}}}},nt=a(0),it={manager:null},st=a.n(nt).a.createContext(it),ot=a(6),ut=a(117),rt=function(t){var e=t.children,a=Object(ut.useGetLocale)(),n=Object(nt.useMemo)((function(){return new et(at,a)}),[]);return Object(nt.useEffect)((function(){return function(){null===n||void 0===n||n.removeAllListeners()}}),[]),Object(ot.jsx)(st.Provider,{value:{manager:n},children:e})};function ct(){return Object(nt.useContext)(st)}}}]);
//# sourceMappingURL=25.5610f7c7.chunk.js.map